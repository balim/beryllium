sudo: false
language: java
jdk:
  - oraclejdk8
services:
  - mysql
  - redis-server
cache:
  directories:
  - $HOME/.m2
install: true
before_script:
  - mysql -e 'create database myapp_test;'
  - rm -rf ~/.linuxbrew
  - yes | ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/linuxbrew/go/install)"
  - export PATH="$HOME/.linuxbrew/bin:$PATH"
  - export MANPATH="$HOME/.linuxbrew/share/man:$MANPATH"
  - export INFOPATH="$HOME/.linuxbrew/share/info:$INFOPATH"
  - brew install jdk
#  - gpg --import beryllium.key
script:
  - mvn install cobertura:cobertura
after_success:
  - mvn coveralls:report
  - if [[ "$TRAVIS_BRANCH" == "master" ]]; then
      mvn deploy --settings ~/settings.xml  -DskipTests;
    fi
  - if [ \( -n "${TRAVIS_TAG}" \) -a  "${TRAVIS_PULL_REQUEST}" = "false" ]; then mvn deploy; fi;

